{"version":3,"file":"app.8b9dec66f0b767fa920b.hot-update.js","sources":["/Users/xavier/Programming/React/percentag/src/recommend.js"],"sourcesContent":["/*global chrome*/\nimport React, { Component } from 'react';\nimport RecomPaper from './recomPaper';\n\nexport default class Recommend extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            recommended:\n                [\n                    // {title: \"\"},\n                    {\n                        index:0,\n                        title: \"Former BoE governor Mark Carney joins board of digital payments firm Stripe\",\n                        img: \"https://cdn.dealstreetasia.com/uploads/2018/09/Stripe-e1613972852450.png?fit=1024,512?resize=940,528\",\n                        date: Date().toLocaleString(),\n                        match: 93,\n                        url: \"https://www.dealstreetasia.com/stories/boe-mark-carney-stripe-228604/\"\n                    },\n                    {\n                        index:1,\n                        title: \"Asia Digest: Mars Growth invests $4m in Hiver; Stripe backs Safepay\",\n                        img: \"https://cdn.dealstreetasia.com/uploads/2015/12/money-currency-investment-dollars.jpg?fit=980,544?resize=940,528\",\n                        date: Date().toLocaleString(),\n                        match: 77,\n                        url: \"https://www.dealstreetasia.com/stories/mars-growth-hiver-strip-safepay-227585/\"\n                    },\n                    {\n                        index:2,\n                        title: \"BEENEXT, Qualgro invest in Vietnamese edtech startup Edmicro’s pre-Series A+ round\",\n                        img: \"https://cdn.dealstreetasia.com/uploads/2020/08/online-education-e1609923082605.png?fit=950,477?resize=940,528\",\n                        date: Date().toLocaleString(),\n                        match: 65,\n                        url: \"https://www.dealstreetasia.com/stories/vietnam-edtech-edmicro-2m-232597/\"\n                    }\n                ],\n            savedTags: [],\n            resultScore: [],\n        };\n        this.getRecommendation = this.getRecommendation.bind(this);\n        // this.getTag = this.getTag(this);\n    }\n    componentDidMount() {\n\n        let newThis = this;\n        chrome.storage.local.get(['tags'], function (result) {\n            newThis.setState({\n                savedTags: result.tags\n            })\n            newThis.fakeUpdateRecommendation();\n            newThis.getRecommendation();\n            \n        });\n    }\n\n    fakeUpdateRecommendation = async () => {\n        if (Array.isArray(this.state.savedTags) && this.state.savedTags.length === 0) {\n            return this.setState({\n                recommended: [{ title: \"\" }],\n                savedTags: [],\n            })\n        }\n        else {\n            return this.setState({\n                recommended:\n                [\n                    // {title: \"\"},\n                    {\n                        index:0,\n                        title: \"Former BoE governor Mark Carney joins board of digital payments firm Stripe\",\n                        img: \"https://cdn.dealstreetasia.com/uploads/2018/09/Stripe-e1613972852450.png?fit=1024,512?resize=940,528\",\n                        date: Date().toLocaleString(),\n                        match: 93,\n                        url: \"https://www.dealstreetasia.com/stories/boe-mark-carney-stripe-228604/\"\n                    },\n                    {\n                        index:1,\n                        title: \"Asia Digest: Mars Growth invests $4m in Hiver; Stripe backs Safepay\",\n                        img: \"https://cdn.dealstreetasia.com/uploads/2015/12/money-currency-investment-dollars.jpg?fit=980,544?resize=940,528\",\n                        date: Date().toLocaleString(),\n                        match: 77,\n                        url: \"https://www.dealstreetasia.com/stories/mars-growth-hiver-strip-safepay-227585/\"\n                    },\n                    {\n                        index:2,\n                        title: \"BEENEXT, Qualgro invest in Vietnamese edtech startup Edmicro’s pre-Series A+ round\",\n                        img: \"https://cdn.dealstreetasia.com/uploads/2020/08/online-education-e1609923082605.png?fit=950,477?resize=940,528\",\n                        date: Date().toLocaleString(),\n                        match: 65,\n                        url: \"https://www.dealstreetasia.com/stories/vietnam-edtech-edmicro-2m-232597/\"\n                    }\n                ],\n            })\n        }\n    }\n\n    getRecommendation = async () => {\n        console.log(\"savedTages in recommend to be send:\" + this.state.savedTags);\n        let recommendArr = this.state.recommended\n        \n        recommendArr.map(async (recoObj, _idx) => {\n            const response = await fetch('http://localhost:5000/api/getReco', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                    tags: this.state.savedTags,\n                    title: recoObj.title,\n                }),\n            });\n            const body = await response.json();\n            if (response.status !== 200) throw Error(body.message);\n            console.log(body.express[0])\n            let tempState = {\n                index: _idx, \n                score: body.express[0]\n            }\n    \n            this.setState({\n                resultScore: [...this.state.resultScore, tempState]\n            })\n            console.log(this.state.resultScore)\n            this.updateMatchingPercentage();\n        })\n        \n    };\n    updateMatchingPercentage (){\n        let newResult = this.state.resultScore;\n        let tempState = this.state.recommended;\n        newResult.map((obj)=>{\n            let index = obj.index;\n            tempState.map(\n                (recoObj)=>{\n                    if(recoObj.index === index){\n                        recoObj.match = (obj.score*100*2.1).toFixed(2);\n                    }\n                }\n            )\n        })\n    }\n\n    render() {\n        return (\n            <div>\n                <p>Follow more tags to receive recommendations specific to your interest </p>\n                <b>\n                    Recommended For You\n                </b>\n                <RecomPaper recommendation={this.state.recommended} />\n\n            </div>\n\n        )\n    }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;;AAEA;AACA;AACA;AACA;AAFA;AAmDA;AACA;AACA;AAAA;AAAA;AACA;AAFA;AAIA;AAEA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AASA;AACA;AACA;AACA;AACA;AACA;AANA;AASA;AACA;AACA;AACA;AACA;AACA;AANA;AApBA;AA8BA;AACA;AACA;AA1FA;AA4FA;AACA;AAEA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AAFA;AALA;AAUA;AACA;AACA;AACA;AACA;AACA;AAFA;AAKA;AACA;AADA;AAGA;AACA;AACA;AAEA;AACA;AAxHA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AASA;AACA;AACA;AACA;AACA;AACA;AANA;AASA;AACA;AACA;AACA;AACA;AACA;AANA;AASA;AACA;AA9BA;AAgCA;AAEA;AACA;AAAA;AAEA;AACA;AACA;AACA;AADA;AAGA;AACA;AAEA;AACA;AACA;AAyEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AALA;AAAA;AAAA;AAAA;AAAA;AAUA;AACA;AAvJA;;;;A","sourceRoot":""}